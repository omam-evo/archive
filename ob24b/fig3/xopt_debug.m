N = 100;
M = 100;
C = e_vartheta_a_b(0.5,1,0);

% fac = (3^(1/2)*sqrt(128*C^6*M^6*N^9 + 27*C^4*M^4*N^(10)) - 9*C^2*M^2*N^5 )^(1/3);
% x = sqrt(0.5* ...
%  sqrt(2*2^(1/3)/3^(2/3)*fac - 8*2^(2/3)/3^(1/3)*C^2*M^2*N^3/fac + N^2) ...
% + 0.5*sqrt( - 2*2^(1/3)/3^(2/3)*fac + 8*2^(2/3)/3^(1/3)*C^2*M^2*N^3/fac + ...
%        2*N^3/ ...
%         (sqrt(2*2^(1/3)/3^(2/3)*fac - 8*2^(2/3)/3^(1/3)*C^2*M^2*N^3/fac + N^2)) ...
% + 2*N^2) ...
% - 3*N/2);

sph = Sphere;
[sign_opt_num, signzero_num] = sph.signorm_opt_sph(C, M, M*2, N, 'medium');


% fac = (3^(1/2)*sqrt(128*C^6*M^6*N^9 + 27*C^4*M^4*N^(10)) - 9*C^2*M^2*N^5 )^(1/3);
fac = 384^(1/6)*C*M*N^(3/2); %simpli

n1 = 2*2^(1/3)/3^(2/3);
n2 = 8*2^(2/3)/3^(1/3);

x = sqrt(0.5* ...
 sqrt(n1*fac - n2*C^2*M^2*N^3/fac + N^2) ...
+ 0.5*sqrt( - n1*fac + n2*C^2*M^2*N^3/fac + ...
       2*N^3/ ...
        (sqrt(n1*fac - n2*C^2*M^2*N^3/fac + N^2)) ...
+ 2*N^2) ...
- 3*N/2);

sph = Sphere;
[sign_opt_num, signzero_num] = sph.signorm_opt_sph(C, M, M*2, N, 'medium');

sign_opt_new = 6^(3/8)/3^(1/2)*(C*M)^(1/4)*N^(3/8);